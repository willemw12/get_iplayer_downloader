get_iplayer_downloader is a download utility for the BBC get_iplayer program.

This program is a graphical version of the command "get_iplayer --tree", followed by "get_iplayer --pid" or "get_iplayer --info". It displays programmes in a large treeview with two main columns: serie title and episode title plus description.

It is a small utility program for me to try and find out what can be done with standard Python and GTK+ 3. This is after I tried creating a version of the downloader with zenity in bash, which was far too slow.

You can continue using the program, while get_iplayer is downloading in the background. I let the downloads run in one or more terminal windows, so I can see when a download hangs or fails.

Some screenshots:

    https://github.com/willemw12/get_iplayer_downloader/wiki/images/screenshot1.png
    https://github.com/willemw12/get_iplayer_downloader/wiki/images/screenshot2.png

This program works best with a screen resolution higher than 1024x768.

For the latest version go to https://github.com/willemw12/get_iplayer_downloader. For other news go to https://github.com/willemw12/get_iplayer_downloader/wiki.

This program is licensed under GPLv3 (see included file COPYING).

Disclaimer: this program doesn't perform any downloading itself. It relies on the get_iplayer program to do the actual downloading.



Dependencies
============

get_iplayer and its dependencies (http://www.infradead.org/get_iplayer/html/get_iplayer.html).

Python (2.7). Python setuptools (to run setup.py). GNOME libraries for Python (GTK+ 3, ...).

Linux (only required to run get_iplayer in a terminal window). This program may work on other platforms, however, that has not been tested.



Configuration
=============

1) get_iplayer

Currently, get_iplayer_downloader uses two get_iplayer presets: one for radio and podcasts and one for television.

The default preset names used by get_iplayer_downloader are: radio and tv. The preset file names are configurable in get_iplayer_downloader.

Reuse existing preset files or create new presets files. To create new preset files, either run "get_iplayer --preset=radio --prefs-add ...", etc. or edit the preset files ~/.get_iplayer/presets/radio and ~/.get_iplayer/presets/tv directly. 

Here are two preset file examples. Lines starting with # are commented out.

File ~/.get_iplayer/presets/radio:

    aactomp3 1
    #command /usr/local/share/get_iplayer_downloader/scripts/get_iplayer_post_subdir.py --categories="<categories>" --dir="<dir>" --filename="<filename>" --subdir-format="bbc.<week>/<categorymain>_<category>/<longname>" --verbose
    fileprefix <name>-<episode>-<lastbcast>
    isodate 1
    output /var/tmp/get_iplayer_downloader/Music
    radiomode flashaudio,realaudio,flashaac,wma

File ~/.get_iplayer/presets/tv:

    #command /usr/local/share/get_iplayer_downloader/scripts/get_iplayer_post_subdir.py --categories="<categories>" --dir="<dir>" --filename="<filename>" --subdir-format="bbc.<week>/<categorymain>_<category>/<longname>" --verbose
    fileprefix <name>-<episode>-<lastbcast>
    isodate 1
    output /var/tmp/get_iplayer_downloader/Videos
    tvmode flashhigh,flashstd,flashnormal

Now "get_iplayer --preset=radio ..." and "get_iplayer --preset=tv" should work properly from the command line.

Optionally, setup a get_iplayer pvr scheduler (cron job) to download queued programmes.

2) get_iplayer_downloader

Most configuration settings can be managed from the GUI. Other settings can be found in the configuration file (~/.config/get_iplayer_downloader/get_iplayer_downloader.conf), which will be created after running the program for the first time. Make sure the program is not running, before editing the configuration file.

Before downloading programmes for the first time, verify the download paths and terminal emulator program name in the GUI or in the configuration file.

The preconfigured search channels and categories are a reduced set. To start off with category lists containing all available categories, run:

    get_iplayer --preset=radio --flush
    get_iplayer --preset=tv --flush
    <path to this directory>/src/get_iplayer_downloader.py --list-categories --quiet

and put the printed output in the configuration file. The same can be done for channels (get_iplayer_downloader.py --list-channels) or clear the configured channel lists to search in all channels.

If the program crashes when the mouse cursor moves over the first column in the treeview (the column with the checkboxes on the main window), then disable "show-tooltip" in the configuration file or update the GNOME libraries (in particular GTK+ 3).



Installation
============

To execute without installing, run:

    <path to this directory>/src/get_iplayer_downloader.py

There are several ways to install the program.

1)

By a general install script. Run from this directory:

    ./install.sh

Then to execute, run:

    get_iplayer_downloader

or run it from the desktop menu.

To uninstall, run from this directory:

    ./uninstall.sh

If the python 2 (2.7 or higher) executable name is python2, then replace the first command above by:

    python2 <path to this directory>/src/get_iplayer_downloader.py

and update the install.sh and uninstall.sh scripts.

2)

For Debian/Ubuntu, build and install a .deb file:

    # Install build and package tools
    sudo apt-get install python-stdeb

    # Create a .deb file in directory deb_dist from Python setuptools (distutils) files
    sudo rm *.deb
    python setup.py --command-packages=stdeb.command bdist_deb

    # Install .deb file
    sudo dpkg -i deb_dist/python-get-iplayer-downloader_*_all.deb
    rm -rf deb_dist/

3)

For Arch Linux there are two PKGBUILD files. For example, to build and install the latest version:

    rm -rf ~/abs/get_iplayer_downloader-git
    mkdir -p ~/abs/get_iplayer_downloader-git
    cd ~/abs/get_iplayer_downloader-git
    wget https://github.com/willemw12/get_iplayer_downloader/raw/master/extra/abs/get_iplayer_downloader-git/PKGBUILD
    #makepkg -ic --skipchecksums
    makepkg -ic



Keyboard shortcuts
==================

alt + enter     Properties  View properties of highlighted programme (of programme in focus)
ctrl + d        Download    Download or queue selected programmes
ctrl + q        Queue       Queue selected programmes for one-off downloading by get_iplayer pvr
ctrl + f        Find        Go to search entry field on the tool bar
ctrl + t        Toggle      Rotate between programme types (radio, podcast, tv)
ctrl + c        Clear       Clear programme download selection
ctrl + r        Refresh     Refresh programme cache
f1              Help        View keyboard shortcuts

down-arrow                  Go from tool bar to the search result
space or enter              Toggle programme selection in the search result



Extra
=====

File ./extra/get_iplayer_post_subdir.py is a get_iplayer post-processing script. It is an extension to the get_iplayer subdir output option. The script supports additional property substitutions (<category>, <week>, ...) in the output subdirectory names. For more information, run:

    ./extra/get_iplayer_post_subdir.py --help 

To install and configure, copy or link the script to a directory in $PATH, for example:

    ln -s <absolute path to this directory>/extra/get_iplayer_post_subdir.py ~/bin/get_iplayer_post_subdir.py

or add a path in front of the command below. Then put, for example, in ~/.get_iplayer/presets/tv:

    command get_iplayer_post_category.py --categories="<categories>" --dir="<dir>" --filename="<filename>" --subdir-format="bbc.<week>/<categorymain>_<category>/<longname>"

If the python 2 (2.7 or higher) executable name is python2, then start the command with: command python2 get_iplayer_post_category.py.

The script is also installed in /usr/share/get_iplayer_downloader/scripts or in /usr/local/share/get_iplayer_downloader/scripts.

